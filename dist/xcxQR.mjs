var img$2 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAyAAAAHwCAYAAABe0QtuAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAExlJREFUeJzt3U+M33Wdx/H3TKf0n2O1IhlR0LSitC6HXeFQoNsZWw+N1Ig97Mli/JN0N0Y9WQ9Nu+4BEz14gE3wDwnoiZhJka4xhpYCrULCsntgw6JIgx3ASrVQkRnacaZ7MFuzLlgEvq/Pr/N9PJI5dfL9vDq/TNvn9PudGVr3z2dO15laXAAAAF0aqtlh8QEAAEScqcXDrTcAAAD9IUAAAIAYAQIAAMQIEAAAIEaAAAAAMQIEAACIESAAAECMAAEAAGIECAAAECNAAACAGAECAADECBAAACBGgAAAADECBAAAiBEgAABAjAABAABiBAgAABAjQAAAgBgBAgAAxAgQAAAgRoAAAAAxAgQAAIgRIAAAQIwAAQAAYgQIAAAQI0AAAIAYAQIAAMQIEAAAIEaAAAAAMQIEAACIESAAAECMAAEAAGIECAAAECNAAACAGAECAADECBAAACBGgAAAADECBAAAiBEgAABAjAABAABiBAgAABAjQAAAgBgBAgAAxAgQAAAgRoAAAAAxAgQAAIgRIAAAQIwAAQAAYgQIAAAQI0AAAIAYAQIAAMQIEAAAIEaAAAAAMQIEAACIESAAAECMAAEAAGIECAAAECNAAACAGAECAADECBAAACBGgAAAADECBAAAiBEgAABAjAABAABiBAgAABAjQAAAgBgBAgAAxAgQAAAgRoAAAAAxAgQAAIgRIAAAQIwAAQAAYgQIAAAQI0AAAIAYAQIAAMQIEAAAIEaAAAAAMQIEAACIESAAAECMAAEAAGIECAAAECNAAACAGAECAADECBAAACBGgAAAADECBAAAiBEgAABAjAABAABiBAgAABAjQAAAgBgBAgAAxAgQAAAgRoAAAAAxAgQAAIgRIAAAQIwAAQAAYgQIAAAQI0AAAIAYAQIAAMQIEAAAIEaAAAAAMQIEAACIESAAAECMAAEAAGIECAAAECNAAACAGAECAADECBAAACBGgAAAADECBAAAiBEgAABAjAABAABiBAgAABAjQAAAgBgBAgAAxAgQAAAgRoAAAAAxAgQAAIgRIAAAQIwAAQAAYgQIAAAQI0AAAIAYAQIAAMQIEAAAIEaAAAAAMQIEAACIESAAAECMAAEAAGIECAAAECNAAACAGAECAADECBAAACBmpPUAoN+WX1B1xTurLl3VegksbGfOVD0/U/WfU1W//X3rNUCfCRCgiaGq+syGqs9eW7ViSes10B+zc1XfOVz1rwerzrQeA/SSAAGa+KfxP74BWYsXVf3jxqqXZv8YIgBpngEB4t72pqrPbmi9Avptx99XLbug9QqgjwQIEPc3F//xq7BAO8suqPq7S1uvAPpIgABxF422XgBUVb3zLa0XAH3kGRAgbnjo3O9z+vTpuvPOO+vuu++u+++/v44fP979sJ644ooravny5fXxj3+8tm/fXkuW5L8LwMGDB+uHP/xh3XvvvXXkyJH4+QvVe9/73lq+fHlt3ry5duzYURdeeOFffP9X8akI8IYbWrfnjG+CAUT9w5VVu6975V8/cOBAfepTn6qjR4/mRvXUunXranJysi6//PLIeU888URt3769fvrTn0bO67NVq1bVbbfdVlu3bn3F9/mXf6u649+DowDKLVjAgNm3b19t2bJFfIQ8+uijNTExUU8//XTnZz3xxBN17bXXio+QEydO1LZt22r//v2tpwD8HwIEGBjHjx+vT37ykzU7O9t6Sq8cO3asvvCFL3R+zg033FDHjh3r/Bz+ZHZ2tj796U/X6dOnW08BOEuAAAPjm9/8Zp04caL1jF7au3dvPfXUU51d/7777quf/OQnnV2fV3b06NG68847W88AOEuAAAPDrSLtzM/P14EDBzq7/t13393ZtTk3H39gkAgQYGDMzMy0ntBrhw4d6uzaXtu2unxtAf5aAgQYGE8++WTrCb32/PPPd3btX/7yl51dm3N77rnnWk8AOEuAAAAAMQIEAACIESAAAECMAAEAAGJGWg8AeK2Gh4dr5cqVrWcMpPn5+Tp58mTrGa/LypUra3jY18lezsmTJ2t+fr71DIDXRIAA562LLrqofvWrX7WeMZAef/zxet/73td6xuvy0EMP1WWXXdZ6xkB6xzve4afKA+ctX1oCAABiBAgAABAjQAAAgBgBAgAAxAgQAAAgRoAAAAAxAgQAAIgRIAAAQIwAAQAAYgQIAAAQI0AAAIAYAQIAAMQIEAAAIEaAAL00OjpaQ0NDA/+2ZcuW1h+q886WLVuav26v5m10dLT1hwqgCQEC9NJLL73UesKrcurUqdYTzjvny2t7vuwEeKMJEAAAIEaAAAAAMQIEAACIESAAAECMAAEAAGIECAAAECNAAACAGAECAADECBAAACBGgAAAADECBAAAiBEgAABAjAABAABiBAgAABAjQAAAgBgBAgAAxAgQAAAgRoAAAAAxAgQAAIgRIAAAQIwAAQAAYgQIAAAQI0AAAIAYAQIAAMQIEAAAIEaAAAAAMQIEAACIESAAAECMAAEAAGIECAAAECNAAACAGAECAADECBAAACBGgAAAADECBAAAiBEgAABAjAABAABiBAgAABAjQAAAgBgBAgAAxIy0HgDQwpYtW2pmZqb1jHO66qqrWk8476xfv75GRgb/r7dly5a1ngDQxOD/CQ3Qgbvuuqv1BDpy4403tp4AwF/gFiwAACBGgAAAADECBAAAiBEgAABAjAABAABiBAgAABAjQAAAgBgBAgAAxAgQAAAgRoAAAAAxAgQAAIgRIAAAQMxI6wEAr9Xc3FwdOXKk9YyBNDU11XrC6zY1NVWLFi1qPWMgzc3NtZ4A8JoJEOC8dfz48VqzZk3rGXRk06ZNrScA0AG3YAEAADECBAAAiBEgAABAjAABAABiBAgAABAjQICBcckll7Se0Gvvf//7O7u217atyy+/vPUEgLMECDAwxsfHW0/otRUrVnR27Y0bN3Z2bc5t+fLlrScAnCVAgIFx3XXXtZ7QW0NDQ3X99dd3dv2JiQn/CG5o27ZtrScAnCVAgIExPj5eV199desZvbR9+/Zau3ZtZ9dfuXJlfe5zn+vs+ryydevW1Sc+8YnWMwDOEiDAQPnud79bY2NjrWf0yvr16+umm27q/JyvfOUrtX79+s7P4U/GxsZqcnKylixZ0noKwFkCBBgoa9asqcOHD9c111zTesqCt3z58vrSl75U99xzT42OjnZ+3tKlS+vHP/5x3XDDDTU0NNT5eX02PDxc27Ztq4cfftgD6MDAGWk9AODP/W+E3HvvvXXgwIGanp6uqamp1rMWjIsvvrjGx8drYmKiVq5cGT17dHS0brvtttq5c2ft3bu3XnzxxXr88cejGxayN7/5zbVhw4batGlTvetd72o9B+BlCRBgYI2Pj/vOWAvU2rVrO33mBIDB5RYsAAAgRoAAAAAxAgQAAIgRIAAAQIwAAQAAYgQIAAAQI0AAAIAYAQIAAMQIEAAAIEaAAAAAMQIEAACIESAAAECMAAEAAGIECAAAECNAAACAGAECAADECBAAACBGgAAAADECBAAAiBEgAABAjAABAABiRloPAHglTz31VB04cKAOHTpUv/vd71rPWTAuu+yyWrFiRV1//fW1du3ayJmTk5N1xx13dH7Ojh076kMf+lDn53z961+vhx56qPNzvva1r9V73vOezs8BSBIgwMB55pln6vOf/3zt3bu35ufnW89ZsHbt2lXbt2+vm266qUZHRzs965FHHqnvf//7nZ5RVbV58+ZIgBw6dKj27dvX+Tk7d+4UIMCCI0CAgfLYY4/VxMREHTt2rPWUBe/MmTN1++23189//vO65557aunSpa0nAdADngEBBsapU6dq27Zt4iPsgQceqD179rSeAUBPCBBgYHzve9+rRx99tPWMXrr55pvr5MmTrWcA0AMCBBgYk5OTrSf01vT0dB08eLD1DAB6QIAAA2N6err1hF677777Wk8AoAcECDAwHnvssdYTem1qaqr1BAB6QIAAAAAxAgQAAIgRIAAAQIwAAQAAYgQIAAAQM9J6AMBr9fa3v70efPDB1jMG0pNPPlmbNm1qPQMA/h8BApy3Fi1aVKtXr249YyDNzc21ngAAL8stWAAAQIwAAQAAYgQIAAAQI0AAAIAYAQIAAMQIEAAAIEaAAAAAMQIEAACIESAAAECMAAEAAGIECAAAEDPSegAAC9+OHTtq69atnZ9z11131ZVXXtn5OV/+8pdrz549nZ/zgQ98oPMzANIECNBLH/3oR2tmZqb1jHO66qqr6sYbb2w943UbGxursbGxzs/51re+VQ8//HDn5yxZsqQ++MEPdn4OwEIkQIBe+tGPflR/+MMfWs84p7m5udYTAOAN5RkQAAAgRoAAAAAxAgQAAIgRIAAAQIwAAQAAYgQIAAAQI0AAAIAYAQIAAMQIEAAAIEaAAAAAMQIEAACIESAAAECMAAEAAGIECAAAECNAAACAGAECAADECBAAACBGgAAAADECBAAAiBEgAABAjAABAABiBAgAABAjQAAAgJiR1gMAWPhuvvnm+sY3vtH5Obt27aqdO3d2fs5Xv/rV+uIXv9j5Ofv27at169Z1fg5AkgABoHO/+c1v6siRI52fMzs7W6tXr+78nF//+teR38/MzEznZwCkuQULAACIESAAAECMAAEAAGIECAAAECNAAACAGAECAADECBAAACBGgAAAADECBAAAiBEgAABAjAABAABiBAgAABAjQAAAgBgBAgAAxAgQAAAgRoAAvbR06dLWE16VJUuWtJ4AAG+okdYDAFp44YUXWk8AgF7yPyAAAECMAAEAAGIECAAAECNAAACAGAECAADECBAAACBGgADQueHhzF83qXOGhoYi56R+PwBJfg4IAJ3bvXt37d69u/WMN8wPfvCD1hMAzlu+tAIAAMQIEAAAIEaAAAAAMQIEAACIESAAAECM74IFnLeeffbZWrVqVesZA2l+fr71BAB4WQIEOG/Nz8/Xc88913oGAPBXcAsWAAAQI0AAAIAYAQIAAMQIEAAAIEaAAAPjrW99a+sJvfbud7+79QQAekCAAANjw4YNrSf02rJly1pPAKAHBAgwMD784Q+3ntBrPv4AJAgQYGB87GMfq0svvbT1jF665pprauPGja1nANADAgQYGBdccEHdeuuttXjx4tZTemVsbKxuv/321jMA6AkBAgyUzZs31+TkZK1atar1lF64+uqr6/Dhw7VmzZrWUwDoiZHWAwD+3NatW+tnP/tZ3XLLLbV///6anp6uX/ziF61nLRirV6+u8fHx+shHPlITExOt5wDQMwIEiDvzKt7nwgsvrF27dtWuXbs63wN9Nf9qPhkB3mBuwQLinn6+9QKgqurZF1ovAPpIgABx/3G0auZ06xXQb7NzVf/1TOsVQB8JECBu5nTVLfe3XgH99u1DVb/9fesVQB95BgRo4tbDVUsXV33m2qrFi1qvgf548VTVtw9XfedQ6yVAXw2t23PGI2hAM297U9XfXlL1lmVVQ0Ot18DCdvRE1SNPV027BRJoyP+AAE399vdV+/+79QoAIMUzIAAAQIwAAQAAYgQIAAAQI0AAAIAYAQIAAMQIEAAAIEaAAAAAMQIEAACIESAAAECMAAEAAGIECAAAECNAAACAGAECAADECBAAACBGgAAAADECBAAAiBEgAABAjAABAABiBAgAABAjQAAAgBgBAgAAxAgQAAAgRoAAAAAxAgQAAIgRIAAAQIwAAQAAYgQIAAAQI0AAAIAYAQIAAMQIEAAAIEaAAAAAMQIEAACIESAAAECMAAEAAGIECAAAECNAAACAGAECAADECBAAACBGgAAAADECBAAAiBEgAABAjAABAABiBAgAABAjQAAAgBgBAgAAxAgQAAAgRoAAAAAxAgQAAIgRIAAAQIwAAQAAYgQIAAAQI0AAAIAYAQIAAMQIEAAAIEaAAAAAMQIEAACIESAAAECMAAEAAGIECAAAECNAAACAGAECAADECBAAACBGgAAAADECBAAAiBEgAABAjAABAABiBAgAABAjQAAAgBgBAgAAxAgQAAAgRoAAAAAxAgQAAIgRIAAAQIwAAQAAYgQIAAAQI0AAAIAYAQIAAMQIEAAAIEaAAAAAMQIEAACIESAAAECMAAEAAGIECAAAECNAAACAGAECAADECBAAACBGgAAAADECBAAAiBEgAABAjAABAABiBAgAABAjQAAAgBgBAgAAxAgQAAAgRoAAAAAxAgQAAIgRIAAAQIwAAQAAYgQIAAAQI0AAAIAYAQIAAMQIEAAAIEaAAAAAMQIEAACIESAAAECMAAEAAGIECAAAECNAAACAGAECAADECBAAACBGgAAAADECBAAAiBEgAABAjAABAABiBAgAABAjQAAAgBgBAgAAxAgQAAAgRoAAAAAxAgQAAIgRIAAAQIwAAQAAYgQIAAAQI0AAAIAYAQIAAMQIEAAAIEaAAAAAMQIEAACIESAAAECMAAEAAGIECAAAECNAAACAmOEaqtnWIwAAgB4Yqtn/AeClQhhBLa7YAAAAAElFTkSuQmCC";

var img$1 = "data:image/svg+xml,%3c%3fxml version='1.0' encoding='UTF-8' standalone='no'%3f%3e%3c!-- Created with Inkscape (http://www.inkscape.org/) --%3e%3csvg width='100mm' height='100mm' viewBox='0 0 100 100' version='1.1' id='svg1' inkscape:version='1.3.2 (091e20e%2c 2023-11-25)' sodipodi:docname='qr-icon.svg' xmlns:inkscape='http://www.inkscape.org/namespaces/inkscape' xmlns:sodipodi='http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd' xmlns:xlink='http://www.w3.org/1999/xlink' xmlns='http://www.w3.org/2000/svg' xmlns:svg='http://www.w3.org/2000/svg'%3e %3csodipodi:namedview id='namedview1' pagecolor='white' bordercolor='black' borderopacity='0.25' inkscape:showpageshadow='2' inkscape:pageopacity='0.0' inkscape:pagecheckerboard='true' inkscape:deskcolor='%23d1d1d1' inkscape:document-units='mm' inkscape:zoom='1.0614689' inkscape:cx='227.04386' inkscape:cy='162.0396' inkscape:window-width='1520' inkscape:window-height='735' inkscape:window-x='260' inkscape:window-y='128' inkscape:window-maximized='0' inkscape:current-layer='layer1' /%3e %3cdefs id='defs1' /%3e %3cg inkscape:label='Layer 1' inkscape:groupmode='layer' id='layer1' transform='translate(2.5146139%2c2.5146139)'%3e %3cg id='g8' transform='matrix(0.95154722%2c0%2c0%2c0.95154722%2c-0.09197468%2c-0.09197468)'%3e %3crect style='fill:white%3bfill-opacity:1%3bstroke:white%3bstroke-width:4.092%3bstroke-linecap:round%3bstroke-linejoin:round%3bstroke-dasharray:none%3bstroke-opacity:1' id='rect8' width='101' height='101' x='-0.5' y='-0.5' rx='0.054268647' ry='0.054268647' /%3e %3cg id='g3' transform='matrix(1.9799347%2c0%2c0%2c1.9799347%2c-17.8338%2c-22.953093)'%3e %3crect style='fill:black%3bfill-opacity:1%3bstroke:none%3bstroke-width:0.01%3bstroke-linecap:round%3bstroke-linejoin:round' id='rect1' width='10' height='10' x='15.30905' y='17.894636' rx='0.054268647' ry='0.054268647' /%3e %3crect style='fill:none%3bfill-opacity:1%3bstroke:black%3bstroke-width:3%3bstroke-linecap:round%3bstroke-linejoin:round%3bstroke-dasharray:none%3bstroke-opacity:1' id='rect3' width='19.603565' height='19.603565' x='10.507267' y='13.092854' rx='0.054268647' ry='0.054268647' /%3e %3c/g%3e %3cuse x='0' y='0' xlink:href='%23g3' id='use3' transform='translate(-4.8208122e-7%2c55.246417)' /%3e %3cuse x='0' y='0' xlink:href='%23g3' id='use4' transform='translate(55.246416)' /%3e %3crect style='fill:black%3bfill-opacity:1%3bstroke:none%3bstroke-width:0%3bstroke-linecap:round%3bstroke-linejoin:round%3bstroke-dasharray:none%3bstroke-opacity:1' id='rect4' width='12' height='12' x='55.328758' y='55.246418' rx='0.065122396' ry='0.065122396' /%3e %3cuse x='0' y='0' xlink:href='%23rect4' id='use5' transform='translate(12%2c11.999996)' /%3e %3cuse x='0' y='0' xlink:href='%23rect4' id='use6' transform='translate(24%2c23.999992)' /%3e %3cuse x='0' y='0' xlink:href='%23rect4' id='use7' transform='translate(24)' /%3e %3cuse x='0' y='0' xlink:href='%23rect4' id='use8' transform='translate(0%2c23.999992)' /%3e %3c/g%3e %3c/g%3e%3c/svg%3e";

var en$1 = {
	"xcxQR.entry.name": "QR Code Extension Blocks",
	"xcxQR.entry.description": "Generate and read QR code"
};
var ja$1 = {
	"xcxQR.entry.name": "QRコード拡張ブロック",
	"xcxQR.entry.description": "QRコードを作ったり読んだりする"
};
var translations$1 = {
	en: en$1,
	ja: ja$1,
	"ja-Hira": {
	"xcxQR.entry.name": "QRコードかくちょうブロック",
	"xcxQR.entry.description": "QRコードをつくったりよんだりする"
}
};

/**
 * This is an extension for Xcratch.
 */


/**
 * Formatter to translate the messages in this extension.
 * This will be replaced which is used in the React component.
 * @param {object} messageData - data for format-message
 * @returns {string} - translated message for the current locale
 */
var formatMessage$1 = function formatMessage(messageData) {
  return messageData.defaultMessage;
};
var entry = {
  get name() {
    return formatMessage$1({
      id: 'xcxQR.entry.name',
      defaultMessage: 'QR Code',
      description: 'name of the extension'
    });
  },
  extensionId: 'xcxQR',
  extensionURL: 'https://yokobond.github.io/xcx-qr/dist/xcxQR.mjs',
  collaborator: 'yokobond',
  iconURL: img$2,
  insetIconURL: img$1,
  get description() {
    return formatMessage$1({
      defaultMessage: 'an extension for Xcratch',
      description: 'Description for this extension',
      id: 'xcxQR.entry.description'
    });
  },
  featured: true,
  disabled: false,
  bluetoothRequired: false,
  internetConnectionRequired: false,
  helpLink: 'https://yokobond.github.io/xcx-qr/',
  setFormatMessage: function setFormatMessage(formatter) {
    formatMessage$1 = formatter;
  },
  translationMap: translations$1
};

function _classCallCheck$1(a, n) {
  if (!(a instanceof n)) throw new TypeError("Cannot call a class as a function");
}

function _typeof$2(o) {
  "@babel/helpers - typeof";

  return _typeof$2 = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (o) {
    return typeof o;
  } : function (o) {
    return o && "function" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? "symbol" : typeof o;
  }, _typeof$2(o);
}

function toPrimitive$1(t, r) {
  if ("object" != _typeof$2(t) || !t) return t;
  var e = t[Symbol.toPrimitive];
  if (void 0 !== e) {
    var i = e.call(t, r );
    if ("object" != _typeof$2(i)) return i;
    throw new TypeError("@@toPrimitive must return a primitive value.");
  }
  return (String )(t);
}

function toPropertyKey$1(t) {
  var i = toPrimitive$1(t, "string");
  return "symbol" == _typeof$2(i) ? i : i + "";
}

function _defineProperties$1(e, r) {
  for (var t = 0; t < r.length; t++) {
    var o = r[t];
    o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, toPropertyKey$1(o.key), o);
  }
}
function _createClass$1(e, r, t) {
  return r && _defineProperties$1(e.prototype, r), t && _defineProperties$1(e, t), Object.defineProperty(e, "prototype", {
    writable: !1
  }), e;
}

function asyncGeneratorStep(n, t, e, r, o, a, c) {
  try {
    var i = n[a](c),
      u = i.value;
  } catch (n) {
    return void e(n);
  }
  i.done ? t(u) : Promise.resolve(u).then(r, o);
}
function _asyncToGenerator(n) {
  return function () {
    var t = this,
      e = arguments;
    return new Promise(function (r, o) {
      var a = n.apply(t, e);
      function _next(n) {
        asyncGeneratorStep(a, r, o, _next, _throw, "next", n);
      }
      function _throw(n) {
        asyncGeneratorStep(a, r, o, _next, _throw, "throw", n);
      }
      _next(void 0);
    });
  };
}

function getDefaultExportFromCjs (x) {
	return x && x.__esModule && Object.prototype.hasOwnProperty.call(x, 'default') ? x['default'] : x;
}

var regeneratorRuntime$1 = {exports: {}};

var _typeof$1 = {exports: {}};

(function (module) {
  function _typeof(o) {
    "@babel/helpers - typeof";

    return (module.exports = _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (o) {
      return typeof o;
    } : function (o) {
      return o && "function" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? "symbol" : typeof o;
    }, module.exports.__esModule = true, module.exports["default"] = module.exports), _typeof(o);
  }
  module.exports = _typeof, module.exports.__esModule = true, module.exports["default"] = module.exports;
})(_typeof$1);
var _typeofExports = _typeof$1.exports;

(function (module) {
  var _typeof = _typeofExports["default"];
  function _regeneratorRuntime() {

    /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
    module.exports = _regeneratorRuntime = function _regeneratorRuntime() {
      return e;
    }, module.exports.__esModule = true, module.exports["default"] = module.exports;
    var t,
      e = {},
      r = Object.prototype,
      n = r.hasOwnProperty,
      o = Object.defineProperty || function (t, e, r) {
        t[e] = r.value;
      },
      i = "function" == typeof Symbol ? Symbol : {},
      a = i.iterator || "@@iterator",
      c = i.asyncIterator || "@@asyncIterator",
      u = i.toStringTag || "@@toStringTag";
    function define(t, e, r) {
      return Object.defineProperty(t, e, {
        value: r,
        enumerable: !0,
        configurable: !0,
        writable: !0
      }), t[e];
    }
    try {
      define({}, "");
    } catch (t) {
      define = function define(t, e, r) {
        return t[e] = r;
      };
    }
    function wrap(t, e, r, n) {
      var i = e && e.prototype instanceof Generator ? e : Generator,
        a = Object.create(i.prototype),
        c = new Context(n || []);
      return o(a, "_invoke", {
        value: makeInvokeMethod(t, r, c)
      }), a;
    }
    function tryCatch(t, e, r) {
      try {
        return {
          type: "normal",
          arg: t.call(e, r)
        };
      } catch (t) {
        return {
          type: "throw",
          arg: t
        };
      }
    }
    e.wrap = wrap;
    var h = "suspendedStart",
      l = "suspendedYield",
      f = "executing",
      s = "completed",
      y = {};
    function Generator() {}
    function GeneratorFunction() {}
    function GeneratorFunctionPrototype() {}
    var p = {};
    define(p, a, function () {
      return this;
    });
    var d = Object.getPrototypeOf,
      v = d && d(d(values([])));
    v && v !== r && n.call(v, a) && (p = v);
    var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p);
    function defineIteratorMethods(t) {
      ["next", "throw", "return"].forEach(function (e) {
        define(t, e, function (t) {
          return this._invoke(e, t);
        });
      });
    }
    function AsyncIterator(t, e) {
      function invoke(r, o, i, a) {
        var c = tryCatch(t[r], t, o);
        if ("throw" !== c.type) {
          var u = c.arg,
            h = u.value;
          return h && "object" == _typeof(h) && n.call(h, "__await") ? e.resolve(h.__await).then(function (t) {
            invoke("next", t, i, a);
          }, function (t) {
            invoke("throw", t, i, a);
          }) : e.resolve(h).then(function (t) {
            u.value = t, i(u);
          }, function (t) {
            return invoke("throw", t, i, a);
          });
        }
        a(c.arg);
      }
      var r;
      o(this, "_invoke", {
        value: function value(t, n) {
          function callInvokeWithMethodAndArg() {
            return new e(function (e, r) {
              invoke(t, n, e, r);
            });
          }
          return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg();
        }
      });
    }
    function makeInvokeMethod(e, r, n) {
      var o = h;
      return function (i, a) {
        if (o === f) throw Error("Generator is already running");
        if (o === s) {
          if ("throw" === i) throw a;
          return {
            value: t,
            done: !0
          };
        }
        for (n.method = i, n.arg = a;;) {
          var c = n.delegate;
          if (c) {
            var u = maybeInvokeDelegate(c, n);
            if (u) {
              if (u === y) continue;
              return u;
            }
          }
          if ("next" === n.method) n.sent = n._sent = n.arg;else if ("throw" === n.method) {
            if (o === h) throw o = s, n.arg;
            n.dispatchException(n.arg);
          } else "return" === n.method && n.abrupt("return", n.arg);
          o = f;
          var p = tryCatch(e, r, n);
          if ("normal" === p.type) {
            if (o = n.done ? s : l, p.arg === y) continue;
            return {
              value: p.arg,
              done: n.done
            };
          }
          "throw" === p.type && (o = s, n.method = "throw", n.arg = p.arg);
        }
      };
    }
    function maybeInvokeDelegate(e, r) {
      var n = r.method,
        o = e.iterator[n];
      if (o === t) return r.delegate = null, "throw" === n && e.iterator["return"] && (r.method = "return", r.arg = t, maybeInvokeDelegate(e, r), "throw" === r.method) || "return" !== n && (r.method = "throw", r.arg = new TypeError("The iterator does not provide a '" + n + "' method")), y;
      var i = tryCatch(o, e.iterator, r.arg);
      if ("throw" === i.type) return r.method = "throw", r.arg = i.arg, r.delegate = null, y;
      var a = i.arg;
      return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, "return" !== r.method && (r.method = "next", r.arg = t), r.delegate = null, y) : a : (r.method = "throw", r.arg = new TypeError("iterator result is not an object"), r.delegate = null, y);
    }
    function pushTryEntry(t) {
      var e = {
        tryLoc: t[0]
      };
      1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e);
    }
    function resetTryEntry(t) {
      var e = t.completion || {};
      e.type = "normal", delete e.arg, t.completion = e;
    }
    function Context(t) {
      this.tryEntries = [{
        tryLoc: "root"
      }], t.forEach(pushTryEntry, this), this.reset(!0);
    }
    function values(e) {
      if (e || "" === e) {
        var r = e[a];
        if (r) return r.call(e);
        if ("function" == typeof e.next) return e;
        if (!isNaN(e.length)) {
          var o = -1,
            i = function next() {
              for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next;
              return next.value = t, next.done = !0, next;
            };
          return i.next = i;
        }
      }
      throw new TypeError(_typeof(e) + " is not iterable");
    }
    return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, "constructor", {
      value: GeneratorFunctionPrototype,
      configurable: !0
    }), o(GeneratorFunctionPrototype, "constructor", {
      value: GeneratorFunction,
      configurable: !0
    }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, "GeneratorFunction"), e.isGeneratorFunction = function (t) {
      var e = "function" == typeof t && t.constructor;
      return !!e && (e === GeneratorFunction || "GeneratorFunction" === (e.displayName || e.name));
    }, e.mark = function (t) {
      return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, "GeneratorFunction")), t.prototype = Object.create(g), t;
    }, e.awrap = function (t) {
      return {
        __await: t
      };
    }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () {
      return this;
    }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) {
      void 0 === i && (i = Promise);
      var a = new AsyncIterator(wrap(t, r, n, o), i);
      return e.isGeneratorFunction(r) ? a : a.next().then(function (t) {
        return t.done ? t.value : a.next();
      });
    }, defineIteratorMethods(g), define(g, u, "Generator"), define(g, a, function () {
      return this;
    }), define(g, "toString", function () {
      return "[object Generator]";
    }), e.keys = function (t) {
      var e = Object(t),
        r = [];
      for (var n in e) r.push(n);
      return r.reverse(), function next() {
        for (; r.length;) {
          var t = r.pop();
          if (t in e) return next.value = t, next.done = !1, next;
        }
        return next.done = !0, next;
      };
    }, e.values = values, Context.prototype = {
      constructor: Context,
      reset: function reset(e) {
        if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = "next", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) "t" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t);
      },
      stop: function stop() {
        this.done = !0;
        var t = this.tryEntries[0].completion;
        if ("throw" === t.type) throw t.arg;
        return this.rval;
      },
      dispatchException: function dispatchException(e) {
        if (this.done) throw e;
        var r = this;
        function handle(n, o) {
          return a.type = "throw", a.arg = e, r.next = n, o && (r.method = "next", r.arg = t), !!o;
        }
        for (var o = this.tryEntries.length - 1; o >= 0; --o) {
          var i = this.tryEntries[o],
            a = i.completion;
          if ("root" === i.tryLoc) return handle("end");
          if (i.tryLoc <= this.prev) {
            var c = n.call(i, "catchLoc"),
              u = n.call(i, "finallyLoc");
            if (c && u) {
              if (this.prev < i.catchLoc) return handle(i.catchLoc, !0);
              if (this.prev < i.finallyLoc) return handle(i.finallyLoc);
            } else if (c) {
              if (this.prev < i.catchLoc) return handle(i.catchLoc, !0);
            } else {
              if (!u) throw Error("try statement without catch or finally");
              if (this.prev < i.finallyLoc) return handle(i.finallyLoc);
            }
          }
        }
      },
      abrupt: function abrupt(t, e) {
        for (var r = this.tryEntries.length - 1; r >= 0; --r) {
          var o = this.tryEntries[r];
          if (o.tryLoc <= this.prev && n.call(o, "finallyLoc") && this.prev < o.finallyLoc) {
            var i = o;
            break;
          }
        }
        i && ("break" === t || "continue" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null);
        var a = i ? i.completion : {};
        return a.type = t, a.arg = e, i ? (this.method = "next", this.next = i.finallyLoc, y) : this.complete(a);
      },
      complete: function complete(t, e) {
        if ("throw" === t.type) throw t.arg;
        return "break" === t.type || "continue" === t.type ? this.next = t.arg : "return" === t.type ? (this.rval = this.arg = t.arg, this.method = "return", this.next = "end") : "normal" === t.type && e && (this.next = e), y;
      },
      finish: function finish(t) {
        for (var e = this.tryEntries.length - 1; e >= 0; --e) {
          var r = this.tryEntries[e];
          if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y;
        }
      },
      "catch": function _catch(t) {
        for (var e = this.tryEntries.length - 1; e >= 0; --e) {
          var r = this.tryEntries[e];
          if (r.tryLoc === t) {
            var n = r.completion;
            if ("throw" === n.type) {
              var o = n.arg;
              resetTryEntry(r);
            }
            return o;
          }
        }
        throw Error("illegal catch attempt");
      },
      delegateYield: function delegateYield(e, r, n) {
        return this.delegate = {
          iterator: values(e),
          resultName: r,
          nextLoc: n
        }, "next" === this.method && (this.arg = t), y;
      }
    }, e;
  }
  module.exports = _regeneratorRuntime, module.exports.__esModule = true, module.exports["default"] = module.exports;
})(regeneratorRuntime$1);
var regeneratorRuntimeExports = regeneratorRuntime$1.exports;

// TODO(Babel 8): Remove this file.

var runtime = regeneratorRuntimeExports();
var regenerator = runtime;

// Copied from https://github.com/facebook/regenerator/blob/main/packages/runtime/runtime.js#L736=
try {
  regeneratorRuntime = runtime;
} catch (accidentalStrictMode) {
  if ((typeof globalThis === "undefined" ? "undefined" : _typeof$2(globalThis)) === "object") {
    globalThis.regeneratorRuntime = runtime;
  } else {
    Function("r", "regeneratorRuntime = r")(runtime);
  }
}
var _regeneratorRuntime = /*@__PURE__*/getDefaultExportFromCjs(regenerator);

/**
 * Types of block
 * @enum {string}
 */
var BlockType = {
  /**
   * Boolean reporter with hexagonal shape
   */
  BOOLEAN: 'Boolean',
  /**
   * A button (not an actual block) for some special action, like making a variable
   */
  BUTTON: 'button',
  /**
   * Command block
   */
  COMMAND: 'command',
  /**
   * Specialized command block which may or may not run a child branch
   * The thread continues with the next block whether or not a child branch ran.
   */
  CONDITIONAL: 'conditional',
  /**
   * Specialized hat block with no implementation function
   * This stack only runs if the corresponding event is emitted by other code.
   */
  EVENT: 'event',
  /**
   * Hat block which conditionally starts a block stack
   */
  HAT: 'hat',
  /**
   * Specialized command block which may or may not run a child branch
   * If a child branch runs, the thread evaluates the loop block again.
   */
  LOOP: 'loop',
  /**
   * General reporter with numeric or string value
   */
  REPORTER: 'reporter'
};
var blockType = BlockType;
var BlockType$1 = /*@__PURE__*/getDefaultExportFromCjs(blockType);

/**
 * Block argument types
 * @enum {string}
 */
var ArgumentType = {
  /**
   * Numeric value with angle picker
   */
  ANGLE: 'angle',
  /**
   * Boolean value with hexagonal placeholder
   */
  BOOLEAN: 'Boolean',
  /**
   * Numeric value with color picker
   */
  COLOR: 'color',
  /**
   * Numeric value with text field
   */
  NUMBER: 'number',
  /**
   * String value with text field
   */
  STRING: 'string',
  /**
   * String value with matrix field
   */
  MATRIX: 'matrix',
  /**
   * MIDI note number with note picker (piano) field
   */
  NOTE: 'note',
  /**
   * Inline image on block (as part of the label)
   */
  IMAGE: 'image'
};
var argumentType = ArgumentType;
var ArgumentType$1 = /*@__PURE__*/getDefaultExportFromCjs(argumentType);

function _classCallCheck(instance, Constructor) {
  if (!(instance instanceof Constructor)) {
    throw new TypeError("Cannot call a class as a function");
  }
}

function _typeof(o) {
  "@babel/helpers - typeof";

  return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (o) {
    return typeof o;
  } : function (o) {
    return o && "function" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? "symbol" : typeof o;
  }, _typeof(o);
}

function toPrimitive(t, r) {
  if ("object" != _typeof(t) || !t) return t;
  var e = t[Symbol.toPrimitive];
  if (void 0 !== e) {
    var i = e.call(t, r );
    if ("object" != _typeof(i)) return i;
    throw new TypeError("@@toPrimitive must return a primitive value.");
  }
  return (String )(t);
}

function toPropertyKey(t) {
  var i = toPrimitive(t, "string");
  return "symbol" == _typeof(i) ? i : String(i);
}

function _defineProperties(target, props) {
  for (var i = 0; i < props.length; i++) {
    var descriptor = props[i];
    descriptor.enumerable = descriptor.enumerable || false;
    descriptor.configurable = true;
    if ("value" in descriptor) descriptor.writable = true;
    Object.defineProperty(target, toPropertyKey(descriptor.key), descriptor);
  }
}
function _createClass(Constructor, protoProps, staticProps) {
  if (staticProps) _defineProperties(Constructor, staticProps);
  Object.defineProperty(Constructor, "prototype", {
    writable: false
  });
  return Constructor;
}

var Color$1 = /*#__PURE__*/function () {
  function Color() {
    _classCallCheck(this, Color);
  }
  return _createClass(Color, null, [{
    key: "RGB_BLACK",
    get:
    /**
     * @typedef {object} RGBObject - An object representing a color in RGB format.
     * @property {number} r - the red component, in the range [0, 255].
     * @property {number} g - the green component, in the range [0, 255].
     * @property {number} b - the blue component, in the range [0, 255].
     */

    /**
     * @typedef {object} HSVObject - An object representing a color in HSV format.
     * @property {number} h - hue, in the range [0-359).
     * @property {number} s - saturation, in the range [0,1].
     * @property {number} v - value, in the range [0,1].
     */

    /** @type {RGBObject} */
    function get() {
      return {
        r: 0,
        g: 0,
        b: 0
      };
    }

    /** @type {RGBObject} */
  }, {
    key: "RGB_WHITE",
    get: function get() {
      return {
        r: 255,
        g: 255,
        b: 255
      };
    }

    /**
     * Convert a Scratch decimal color to a hex string, #RRGGBB.
     * @param {number} decimal RGB color as a decimal.
     * @return {string} RGB color as #RRGGBB hex string.
     */
  }, {
    key: "decimalToHex",
    value: function decimalToHex(decimal) {
      if (decimal < 0) {
        decimal += 0xFFFFFF + 1;
      }
      var hex = Number(decimal).toString(16);
      hex = "#".concat('000000'.substr(0, 6 - hex.length)).concat(hex);
      return hex;
    }

    /**
     * Convert a Scratch decimal color to an RGB color object.
     * @param {number} decimal RGB color as decimal.
     * @return {RGBObject} rgb - {r: red [0,255], g: green [0,255], b: blue [0,255]}.
     */
  }, {
    key: "decimalToRgb",
    value: function decimalToRgb(decimal) {
      var a = decimal >> 24 & 0xFF;
      var r = decimal >> 16 & 0xFF;
      var g = decimal >> 8 & 0xFF;
      var b = decimal & 0xFF;
      return {
        r: r,
        g: g,
        b: b,
        a: a > 0 ? a : 255
      };
    }

    /**
     * Convert a hex color (e.g., F00, #03F, #0033FF) to an RGB color object.
     * CC-BY-SA Tim Down:
     * https://stackoverflow.com/questions/5623838/rgb-to-hex-and-hex-to-rgb
     * @param {!string} hex Hex representation of the color.
     * @return {RGBObject} null on failure, or rgb: {r: red [0,255], g: green [0,255], b: blue [0,255]}.
     */
  }, {
    key: "hexToRgb",
    value: function hexToRgb(hex) {
      var shorthandRegex = /^#?([a-f\d])([a-f\d])([a-f\d])$/i;
      hex = hex.replace(shorthandRegex, function (m, r, g, b) {
        return r + r + g + g + b + b;
      });
      var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
      return result ? {
        r: parseInt(result[1], 16),
        g: parseInt(result[2], 16),
        b: parseInt(result[3], 16)
      } : null;
    }

    /**
     * Convert an RGB color object to a hex color.
     * @param {RGBObject} rgb - {r: red [0,255], g: green [0,255], b: blue [0,255]}.
     * @return {!string} Hex representation of the color.
     */
  }, {
    key: "rgbToHex",
    value: function rgbToHex(rgb) {
      return Color.decimalToHex(Color.rgbToDecimal(rgb));
    }

    /**
     * Convert an RGB color object to a Scratch decimal color.
     * @param {RGBObject} rgb - {r: red [0,255], g: green [0,255], b: blue [0,255]}.
     * @return {!number} Number representing the color.
     */
  }, {
    key: "rgbToDecimal",
    value: function rgbToDecimal(rgb) {
      return (rgb.r << 16) + (rgb.g << 8) + rgb.b;
    }

    /**
    * Convert a hex color (e.g., F00, #03F, #0033FF) to a decimal color number.
    * @param {!string} hex Hex representation of the color.
    * @return {!number} Number representing the color.
    */
  }, {
    key: "hexToDecimal",
    value: function hexToDecimal(hex) {
      return Color.rgbToDecimal(Color.hexToRgb(hex));
    }

    /**
     * Convert an HSV color to RGB format.
     * @param {HSVObject} hsv - {h: hue [0,360), s: saturation [0,1], v: value [0,1]}
     * @return {RGBObject} rgb - {r: red [0,255], g: green [0,255], b: blue [0,255]}.
     */
  }, {
    key: "hsvToRgb",
    value: function hsvToRgb(hsv) {
      var h = hsv.h % 360;
      if (h < 0) h += 360;
      var s = Math.max(0, Math.min(hsv.s, 1));
      var v = Math.max(0, Math.min(hsv.v, 1));
      var i = Math.floor(h / 60);
      var f = h / 60 - i;
      var p = v * (1 - s);
      var q = v * (1 - s * f);
      var t = v * (1 - s * (1 - f));
      var r;
      var g;
      var b;
      switch (i) {
        default:
        case 0:
          r = v;
          g = t;
          b = p;
          break;
        case 1:
          r = q;
          g = v;
          b = p;
          break;
        case 2:
          r = p;
          g = v;
          b = t;
          break;
        case 3:
          r = p;
          g = q;
          b = v;
          break;
        case 4:
          r = t;
          g = p;
          b = v;
          break;
        case 5:
          r = v;
          g = p;
          b = q;
          break;
      }
      return {
        r: Math.floor(r * 255),
        g: Math.floor(g * 255),
        b: Math.floor(b * 255)
      };
    }

    /**
     * Convert an RGB color to HSV format.
     * @param {RGBObject} rgb - {r: red [0,255], g: green [0,255], b: blue [0,255]}.
     * @return {HSVObject} hsv - {h: hue [0,360), s: saturation [0,1], v: value [0,1]}
     */
  }, {
    key: "rgbToHsv",
    value: function rgbToHsv(rgb) {
      var r = rgb.r / 255;
      var g = rgb.g / 255;
      var b = rgb.b / 255;
      var x = Math.min(Math.min(r, g), b);
      var v = Math.max(Math.max(r, g), b);

      // For grays, hue will be arbitrarily reported as zero. Otherwise, calculate
      var h = 0;
      var s = 0;
      if (x !== v) {
        var f = r === x ? g - b : g === x ? b - r : r - g;
        var i = r === x ? 3 : g === x ? 5 : 1;
        h = (i - f / (v - x)) * 60 % 360;
        s = (v - x) / v;
      }
      return {
        h: h,
        s: s,
        v: v
      };
    }

    /**
     * Linear interpolation between rgb0 and rgb1.
     * @param {RGBObject} rgb0 - the color corresponding to fraction1 <= 0.
     * @param {RGBObject} rgb1 - the color corresponding to fraction1 >= 1.
     * @param {number} fraction1 - the interpolation parameter. If this is 0.5, for example, mix the two colors equally.
     * @return {RGBObject} the interpolated color.
     */
  }, {
    key: "mixRgb",
    value: function mixRgb(rgb0, rgb1, fraction1) {
      if (fraction1 <= 0) return rgb0;
      if (fraction1 >= 1) return rgb1;
      var fraction0 = 1 - fraction1;
      return {
        r: fraction0 * rgb0.r + fraction1 * rgb1.r,
        g: fraction0 * rgb0.g + fraction1 * rgb1.g,
        b: fraction0 * rgb0.b + fraction1 * rgb1.b
      };
    }
  }]);
}();
var color = Color$1;

var Color = color;

/**
 * @fileoverview
 * Utilities for casting and comparing Scratch data-types.
 * Scratch behaves slightly differently from JavaScript in many respects,
 * and these differences should be encapsulated below.
 * For example, in Scratch, add(1, join("hello", world")) -> 1.
 * This is because "hello world" is cast to 0.
 * In JavaScript, 1 + Number("hello" + "world") would give you NaN.
 * Use when coercing a value before computation.
 */
var Cast = /*#__PURE__*/function () {
  function Cast() {
    _classCallCheck(this, Cast);
  }
  return _createClass(Cast, null, [{
    key: "toNumber",
    value:
    /**
     * Scratch cast to number.
     * Treats NaN as 0.
     * In Scratch 2.0, this is captured by `interp.numArg.`
     * @param {*} value Value to cast to number.
     * @return {number} The Scratch-casted number value.
     */
    function toNumber(value) {
      // If value is already a number we don't need to coerce it with
      // Number().
      if (typeof value === 'number') {
        // Scratch treats NaN as 0, when needed as a number.
        // E.g., 0 + NaN -> 0.
        if (Number.isNaN(value)) {
          return 0;
        }
        return value;
      }
      // Replace full-width numbers with half-width ones.
      value = value.replace(/[０-９＋．ｅ]/g, function (s) {
        return String.fromCharCode(s.charCodeAt(0) - 0xFEE0);
      });
      value = value.replace(/[-－﹣−‐⁃‑‒–—﹘―⎯⏤ーｰ─━]/g, '-');
      var n = Number(value);
      if (Number.isNaN(n)) {
        // Scratch treats NaN as 0, when needed as a number.
        // E.g., 0 + NaN -> 0.
        return 0;
      }
      return n;
    }

    /**
     * Scratch cast to boolean.
     * In Scratch 2.0, this is captured by `interp.boolArg.`
     * Treats some string values differently from JavaScript.
     * @param {*} value Value to cast to boolean.
     * @return {boolean} The Scratch-casted boolean value.
     */
  }, {
    key: "toBoolean",
    value: function toBoolean(value) {
      // Already a boolean?
      if (typeof value === 'boolean') {
        return value;
      }
      if (typeof value === 'string') {
        // These specific strings are treated as false in Scratch.
        if (value === '' || value === '0' || value.toLowerCase() === 'false') {
          return false;
        }
        // All other strings treated as true.
        return true;
      }
      // Coerce other values and numbers.
      return Boolean(value);
    }

    /**
     * Scratch cast to string.
     * @param {*} value Value to cast to string.
     * @return {string} The Scratch-casted string value.
     */
  }, {
    key: "toString",
    value: function toString(value) {
      return String(value).replace(/\\n/g, '\n').replace(/\\t/g, '\t');
    }

    /**
     * Cast any Scratch argument to an RGB color array to be used for the renderer.
     * @param {*} value Value to convert to RGB color array.
     * @return {Array.<number>} [r,g,b], values between 0-255.
     */
  }, {
    key: "toRgbColorList",
    value: function toRgbColorList(value) {
      var color = Cast.toRgbColorObject(value);
      return [color.r, color.g, color.b];
    }

    /**
     * Cast any Scratch argument to an RGB color object to be used for the renderer.
     * @param {*} value Value to convert to RGB color object.
     * @return {RGBOject} [r,g,b], values between 0-255.
     */
  }, {
    key: "toRgbColorObject",
    value: function toRgbColorObject(value) {
      var color;
      if (typeof value === 'string' && value.substring(0, 1) === '#') {
        color = Color.hexToRgb(value);

        // If the color wasn't *actually* a hex color, cast to black
        if (!color) color = {
          r: 0,
          g: 0,
          b: 0,
          a: 255
        };
      } else {
        color = Color.decimalToRgb(Cast.toNumber(value));
      }
      return color;
    }

    /**
     * Determine if a Scratch argument is a white space string (or null / empty).
     * @param {*} val value to check.
     * @return {boolean} True if the argument is all white spaces or null / empty.
     */
  }, {
    key: "isWhiteSpace",
    value: function isWhiteSpace(val) {
      return val === null || typeof val === 'string' && val.trim().length === 0;
    }

    /**
     * Compare two values, using Scratch cast, case-insensitive string compare, etc.
     * In Scratch 2.0, this is captured by `interp.compare.`
     * @param {*} v1 First value to compare.
     * @param {*} v2 Second value to compare.
     * @returns {number} Negative number if v1 < v2; 0 if equal; positive otherwise.
     */
  }, {
    key: "compare",
    value: function compare(v1, v2) {
      var n1 = Number(v1);
      var n2 = Number(v2);
      if (n1 === 0 && Cast.isWhiteSpace(v1)) {
        n1 = NaN;
      } else if (n2 === 0 && Cast.isWhiteSpace(v2)) {
        n2 = NaN;
      }
      if (isNaN(n1) || isNaN(n2)) {
        // At least one argument can't be converted to a number.
        // Scratch compares strings as case insensitive.
        var s1 = Cast.toString(v1).toLowerCase();
        var s2 = Cast.toString(v2).toLowerCase();
        if (s1 < s2) {
          return -1;
        } else if (s1 > s2) {
          return 1;
        }
        return 0;
      }
      // Handle the special case of Infinity
      if (n1 === Infinity && n2 === Infinity || n1 === -Infinity && n2 === -Infinity) {
        return 0;
      }
      // Compare as numbers.
      return n1 - n2;
    }

    /**
     * Determine if a Scratch argument number represents a round integer.
     * @param {*} val Value to check.
     * @return {boolean} True if number looks like an integer.
     */
  }, {
    key: "isInt",
    value: function isInt(val) {
      // Values that are already numbers.
      if (typeof val === 'number') {
        if (isNaN(val)) {
          // NaN is considered an integer.
          return true;
        }
        // True if it's "round" (e.g., 2.0 and 2).
        return val === parseInt(val, 10);
      } else if (typeof val === 'boolean') {
        // `True` and `false` always represent integer after Scratch cast.
        return true;
      } else if (typeof val === 'string') {
        // If it contains a decimal point, don't consider it an int.
        return val.indexOf('.') < 0;
      }
      return false;
    }
  }, {
    key: "LIST_INVALID",
    get: function get() {
      return 'INVALID';
    }
  }, {
    key: "LIST_ALL",
    get: function get() {
      return 'ALL';
    }

    /**
     * Compute a 1-based index into a list, based on a Scratch argument.
     * Two special cases may be returned:
     * LIST_ALL: if the block is referring to all of the items in the list.
     * LIST_INVALID: if the index was invalid in any way.
     * @param {*} index Scratch arg, including 1-based numbers or special cases.
     * @param {number} length Length of the list.
     * @param {boolean} acceptAll Whether it should accept "all" or not.
     * @return {(number|string)} 1-based index for list, LIST_ALL, or LIST_INVALID.
     */
  }, {
    key: "toListIndex",
    value: function toListIndex(index, length, acceptAll) {
      if (typeof index !== 'number') {
        if (index === 'all') {
          return acceptAll ? Cast.LIST_ALL : Cast.LIST_INVALID;
        }
        if (index === 'last') {
          if (length > 0) {
            return length;
          }
          return Cast.LIST_INVALID;
        } else if (index === 'random' || index === 'any') {
          if (length > 0) {
            return 1 + Math.floor(Math.random() * length);
          }
          return Cast.LIST_INVALID;
        }
      }
      index = Math.floor(Cast.toNumber(index));
      if (index < 1 || index > length) {
        return Cast.LIST_INVALID;
      }
      return index;
    }
  }]);
}();
var cast = Cast;
var Cast$1 = /*@__PURE__*/getDefaultExportFromCjs(cast);

var en = {
	"xcxQR.name": "QR Code",
	"xcxQR.generateQRCode": "[TEXT] to QR code",
	"xcxQR.startQRScan": "start scan QR code",
	"xcxQR.stopQRScan": "stop scan QR code",
	"xcxQR.reportQRData": "QR code data",
	"xcxQR.reportQRCornerPoint": "QR code [CORNER] [POINT]",
	"xcxQR.whenQRIsRead": "when QR code is read",
	"xcxQR.topLeft": "top left",
	"xcxQR.topRight": "top right",
	"xcxQR.bottomLeft": "bottom left",
	"xcxQR.bottomRight": "bottom right"
};
var ja = {
	"xcxQR.name": "QRコード",
	"xcxQR.generateQRCode": "[TEXT]をQRコードにする",
	"xcxQR.startQRScan": "QRコードの読み取りを始める",
	"xcxQR.stopQRScan": "QRコードの読み取りを止める",
	"xcxQR.reportQRData": "QRコードのデータ",
	"xcxQR.reportQRCornerPoint": "QRコードの[CORNER]の[POINT]座標",
	"xcxQR.whenQRIsRead": "QRコードが読み取られたとき",
	"xcxQR.topLeft": "左上",
	"xcxQR.topRight": "右上",
	"xcxQR.bottomLeft": "左下",
	"xcxQR.bottomRight": "右下"
};
var translations = {
	en: en,
	ja: ja,
	"ja-Hira": {
	"xcxQR.name": "QRコード",
	"xcxQR.generateQRCode": "[TEXT]をQRコードにする",
	"xcxQR.startQRScan": "QRコードのよみとりをはじめる",
	"xcxQR.stopQRScan": "QRコードのよみとりをとめる",
	"xcxQR.reportQRData": "QRコードのデータ",
	"xcxQR.reportQRCornerPoint": "QRコードの[CORNER]の[POINT]ざひょう",
	"xcxQR.whenQRIsRead": "QRコードがよみとられたとき",
	"xcxQR.topLeft": "ひだりうえ",
	"xcxQR.topRight": "みぎうえ",
	"xcxQR.bottomLeft": "ひだりした",
	"xcxQR.bottomRight": "みぎした"
}
};

var img = "data:image/png;base64,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";

var QRCode;
_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {
  return _regeneratorRuntime.wrap(function _callee$(_context) {
    while (1) switch (_context.prev = _context.next) {
      case 0:
        _context.next = 2;
        return import( /* webpackIgnore: true */
        'https://cdn.jsdelivr.net/npm/qrcode@1.5.3/+esm');
      case 2:
        QRCode = _context.sent;
      case 3:
      case "end":
        return _context.stop();
    }
  }, _callee);
}))();
var QrScanner;
var qrEngine;
_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {
  return _regeneratorRuntime.wrap(function _callee2$(_context2) {
    while (1) switch (_context2.prev = _context2.next) {
      case 0:
        _context2.next = 2;
        return import( /* webpackIgnore: true */
        'https://cdn.jsdelivr.net/npm/qr-scanner@1.4.2/+esm');
      case 2:
        QrScanner = _context2.sent.default;
        _context2.next = 5;
        return QrScanner.createQrEngine(QrScanner.WORKER_PATH);
      case 5:
        qrEngine = _context2.sent;
      case 6:
      case "end":
        return _context2.stop();
    }
  }, _callee2);
}))();

/**
 * Formatter which is used for translation.
 * This will be replaced which is used in the runtime.
 * @param {object} messageData - format-message object
 * @returns {string} - message for the locale
 */
var formatMessage = function formatMessage(messageData) {
  return messageData.default;
};

/**
 * Setup format-message for this extension.
 */
var setupTranslations = function setupTranslations() {
  var localeSetup = formatMessage.setup();
  if (localeSetup && localeSetup.translations[localeSetup.locale]) {
    Object.assign(localeSetup.translations[localeSetup.locale], translations[localeSetup.locale]);
  }
};
var EXTENSION_ID = 'xcxQR';

/**
 * URL to get this extension as a module.
 * When it was loaded as a module, 'extensionURL' will be replaced a URL which is retrieved from.
 * @type {string}
 */
var extensionURL = 'https://yokobond.github.io/xcx-qr/dist/xcxQR.mjs';

/**
 * Scratch 3.0 blocks for example of Xcratch.
 */
var ExtensionBlocks = /*#__PURE__*/function () {
  /**
   * Construct a set of blocks for QR Code.
   * @param {Runtime} runtime - the Scratch 3.0 runtime.
   */
  function ExtensionBlocks(runtime) {
    _classCallCheck$1(this, ExtensionBlocks);
    /**
     * The Scratch 3.0 runtime.
     * @type {Runtime}
     */
    this.runtime = runtime;
    if (runtime.formatMessage) {
      // Replace 'formatMessage' to a formatter which is used in the runtime.
      formatMessage = runtime.formatMessage;
    }
    this.scanTimer = null;
    this.scanInterval = 100;
    this.scannedData = '';
    this.scannedCornerPoints = [{
      x: 0,
      y: 0
    }, {
      x: 0,
      y: 0
    }, {
      x: 0,
      y: 0
    }, {
      x: 0,
      y: 0
    }];
  }

  /**
   * @returns {object} metadata for this extension and its blocks.
   */
  return _createClass$1(ExtensionBlocks, [{
    key: "getInfo",
    value: function getInfo() {
      setupTranslations();
      return {
        id: ExtensionBlocks.EXTENSION_ID,
        name: ExtensionBlocks.EXTENSION_NAME,
        extensionURL: ExtensionBlocks.extensionURL,
        blockIconURI: img,
        showStatusButton: false,
        blocks: [{
          opcode: 'generateQRCode',
          blockType: BlockType$1.REPORTER,
          text: formatMessage({
            id: 'xcxQR.generateQRCode',
            default: '[TEXT] to QR code'
          }),
          disableMonitor: true,
          func: 'generateQRCode',
          arguments: {
            TEXT: {
              type: ArgumentType$1.STRING,
              defaultValue: formatMessage({
                id: 'xcxQR.generateQRCode.defaultText',
                default: 'QR'
              })
            }
          }
        }, '---', {
          opcode: 'startQRScan',
          blockType: BlockType$1.COMMAND,
          text: formatMessage({
            id: 'xcxQR.startQRScan',
            default: 'start scan QR code'
          }),
          func: 'startQRScan',
          arguments: {}
        }, {
          opcode: 'stopQRScan',
          blockType: BlockType$1.COMMAND,
          text: formatMessage({
            id: 'xcxQR.stopQRScan',
            default: 'stop scan QR code'
          }),
          func: 'stopQRScan',
          arguments: {}
        }, {
          opcode: 'reportQRData',
          blockType: BlockType$1.REPORTER,
          disableMonitor: false,
          text: formatMessage({
            id: 'xcxQR.reportQRData',
            default: 'QR code data'
          }),
          func: 'reportQRData',
          arguments: {}
        }, {
          opcode: 'reportQRCornerPoint',
          blockType: BlockType$1.REPORTER,
          disableMonitor: true,
          text: formatMessage({
            id: 'xcxQR.reportQRCornerPoint',
            default: 'QR code [CORNER] [POINT]'
          }),
          func: 'reportQRCornerPoint',
          arguments: {
            CORNER: {
              type: ArgumentType$1.STRING,
              menu: 'qrCornerMenu',
              defaultValue: 'topLeft'
            },
            POINT: {
              type: ArgumentType$1.STRING,
              menu: 'qrPointMenu',
              defaultValue: 'x'
            }
          }
        }, {
          opcode: 'whenQRIsRead',
          blockType: BlockType$1.EVENT,
          text: formatMessage({
            id: 'xcxQR.whenQRIsRead',
            default: 'when QR code is read'
          }),
          isEdgeActivated: false,
          shouldRestartExistingThreads: true
        }],
        menus: {
          qrCornerMenu: {
            acceptReporters: false,
            items: 'getCornerMenu'
          },
          qrPointMenu: {
            acceptReporters: false,
            items: 'getPointMenu'
          }
        }
      };
    }
  }, {
    key: "getCornerMenu",
    value: function getCornerMenu() {
      return [{
        text: formatMessage({
          id: 'xcxQR.topLeft',
          default: 'top left'
        }),
        value: 'topLeft'
      }, {
        text: formatMessage({
          id: 'xcxQR.topRight',
          default: 'top right'
        }),
        value: 'topRight'
      }, {
        text: formatMessage({
          id: 'xcxQR.bottomRight',
          default: 'bottom right'
        }),
        value: 'bottomRight'
      }, {
        text: formatMessage({
          id: 'xcxQR.bottomLeft',
          default: 'bottom left'
        }),
        value: 'bottomLeft'
      }];
    }
  }, {
    key: "getPointMenu",
    value: function getPointMenu() {
      return ['x', 'y'];
    }
  }, {
    key: "generateQRCode",
    value: function generateQRCode(args) {
      var text = Cast$1.toString(args.TEXT);
      return QRCode.toDataURL(text);
    }

    /**
     * Return snapshot image dataURL.
     * @returns {Promise<string>} - resolves snapshot dataURL
     */
  }, {
    key: "snapshotData",
    value: function snapshotData() {
      var _this = this;
      return new Promise(function (resolve) {
        _this.runtime.renderer.requestSnapshot(function (imageDataURL) {
          resolve(imageDataURL);
        });
      });
    }

    /**
     * Read QR code from an image.
     * @returns {Promise<object>} - resolves scan result or null for no QR code
     */
  }, {
    key: "scanQR",
    value: (function () {
      var _scanQR = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {
        var runtime, canvasWidth, canvasHeight, dataURL, scanResult;
        return _regeneratorRuntime.wrap(function _callee3$(_context3) {
          while (1) switch (_context3.prev = _context3.next) {
            case 0:
              runtime = this.runtime;
              canvasWidth = 960;
              canvasHeight = 720;
              _context3.next = 5;
              return new Promise(function (resolve) {
                runtime.renderer.requestSnapshot(function (imageDataURL) {
                  canvasWidth = runtime.renderer.canvas.width;
                  canvasHeight = runtime.renderer.canvas.height;
                  resolve(imageDataURL);
                });
              });
            case 5:
              dataURL = _context3.sent;
              _context3.prev = 6;
              _context3.next = 9;
              return QrScanner.scanImage(dataURL, {
                qrEngine: qrEngine,
                returnDetailedScanResult: true
              });
            case 9:
              scanResult = _context3.sent;
              if (!(!scanResult || !scanResult.data)) {
                _context3.next = 12;
                break;
              }
              return _context3.abrupt("return", null);
            case 12:
              this.scannedData = scanResult.data;
              this.scannedCornerPoints = scanResult.cornerPoints.map(function (point) {
                return {
                  x: point.x * (480 / canvasWidth) - 240,
                  y: 180 - point.y * (360 / canvasHeight)
                };
              });
              if (scanResult) {
                runtime.startHats('xcxQR_whenQRIsRead');
              }
              return _context3.abrupt("return", scanResult);
            case 18:
              _context3.prev = 18;
              _context3.t0 = _context3["catch"](6);
              return _context3.abrupt("return", null);
            case 21:
            case "end":
              return _context3.stop();
          }
        }, _callee3, this, [[6, 18]]);
      }));
      function scanQR() {
        return _scanQR.apply(this, arguments);
      }
      return scanQR;
    }()
    /**
     * Start QR scan.
     */
    )
  }, {
    key: "startQRScan",
    value: function startQRScan() {
      var _this2 = this;
      if (this.scanTimer) {
        return; // already started
      }
      this.scanTimer = setTimeout(function () {
        _this2.scanQR().catch(function () {
          // ignore no QR code
        }).finally(function () {
          _this2.scanTimer = null;
          _this2.startQRScan();
        });
      }, this.scanInterval);
    }
  }, {
    key: "stopQRScan",
    value: function stopQRScan() {
      if (this.scanTimer) {
        clearTimeout(this.scanTimer);
        this.scanTimer = null;
      }
    }
  }, {
    key: "reportQRData",
    value: function reportQRData() {
      return this.scannedData;
    }
  }, {
    key: "reportQRCornerPoint",
    value: function reportQRCornerPoint(args) {
      var corner = args.CORNER;
      var point = args.POINT;
      var index = ['topLeft', 'topRight', 'bottomRight', 'bottomLeft'].indexOf(corner);
      if (index < 0) {
        return 0;
      }
      return this.scannedCornerPoints[index][point];
    }
  }], [{
    key: "formatMessage",
    set:
    /**
     * A translation object which is used in this class.
     * @param {FormatObject} formatter - translation object
     */
    function set(formatter) {
      formatMessage = formatter;
      if (formatMessage) setupTranslations();
    }

    /**
     * @return {string} - the name of this extension.
     */
  }, {
    key: "EXTENSION_NAME",
    get: function get() {
      return formatMessage({
        id: 'xcxQR.name',
        default: 'QR Code',
        description: 'name of the extension'
      });
    }

    /**
     * @return {string} - the ID of this extension.
     */
  }, {
    key: "EXTENSION_ID",
    get: function get() {
      return EXTENSION_ID;
    }

    /**
     * URL to get this extension.
     * @type {string}
     */
  }, {
    key: "extensionURL",
    get: function get() {
      return extensionURL;
    }

    /**
     * Set URL to get this extension.
     * The extensionURL will be changed to the URL of the loading server.
     * @param {string} url - URL
     */,
    set: function set(url) {
      extensionURL = url;
    }
  }]);
}();

export { ExtensionBlocks as blockClass, entry };
//# sourceMappingURL=xcxQR.mjs.map
